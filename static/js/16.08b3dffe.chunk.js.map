{"version":3,"sources":["configs/variable.js","components/Message.js","components/Loader.js","provider/dashboardFetch.js","views/dashboard/Dashboard.js"],"names":["variable","env","endpointLocal","endpointProd","Message","variant","children","color","defaultProps","Loader","className","getDashboard","a","config","headers","endpoint","url","axios","get","data","status","message","response","error","getChiffreAffaires","body","post","WidgetsDropdownCustom","lazy","Dashboard","useState","footerStat","setFooterStat","chiffreAffaires","setChiffreAffaires","setError","errorCA","setErrorCA","type","setType","setStatus","labels","setLabels","setData","useEffect","resp","resp_1","console","log","fetch","labelsTMP","dataTMP","dataGlobal","ordersChiffresGroupedByDayStatus","length","ordersChiffresGroupedByMonthWithStatus","ordersChiffresGroupedByYearWithStatus","order","moment","updatedAt","format","total","toggleType","value","key","countClient","countCommercant","countAdmin","countOrder","sm","id","onChange","e","target","map","onClick","active","style","height","marginTop","datasets","label","backgroundColor","hexToRgba","getStyle","borderColor","pointHoverBackgroundColor","borderWidth","fill","options","maintainAspectRatio","plugins","legend","display","scales","x","grid","drawOnChartArea","y","ticks","beginAtZero","maxTicksLimit","elements","line","tension","point","radius","hitRadius","hoverRadius","hoverBorderWidth","xs","cols","md","orderStat","item","index","title","percent","thin","Number"],"mappings":"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","file":"static/js/16.08b3dffe.chunk.js","sourcesContent":["export const variable = {\r\n    env: 'prod', // local | prod\r\n    endpointLocal: 'http://127.0.0.1:5059',\r\n    endpointProd:'https://projet-eats-nrh.herokuapp.com',\r\n}","import React from 'react'\r\nimport {CAlert} from '@coreui/react'\r\n\r\nconst Message = ({variant, children}) => {\r\n    return <CAlert color={variant}>\r\n        { children }\r\n    </CAlert>\r\n}\r\n\r\nMessage.defaultProps = {\r\n    variant: 'info'\r\n}\r\n\r\nexport default Message\r\n","import React from 'react'\r\nimport {CSpinner} from '@coreui/react'\r\n\r\nconst Loader = () => {\r\n    return <>\r\n    <CSpinner color=\"primary\" >\r\n        <span className='sr-only'>Loading ...</span>\r\n    </CSpinner>\r\n    </>\r\n}\r\n\r\nexport default Loader","import axios from 'axios'\r\nimport { variable } from '../configs/variable'\r\n\r\nexport const getDashboard = async () => {\r\n    try {\r\n\r\n        const config = {\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        }\r\n\r\n        const endpoint = variable.env === 'local' ? variable.endpointLocal : variable.endpointProd\r\n\r\n        const url  = `${endpoint}/api/dashboard`\r\n\r\n        const { data } = await axios.get(`${url}`, config)\r\n\r\n        return {status: true, data}\r\n    } catch (error) {\r\n        const message = error.response && error.response.data.message\r\n                ? error.response.data.message\r\n                : error.message\r\n        \r\n        return {status: false, error: message}\r\n    }\r\n}\r\n\r\nexport const getOrders = async (body) => {\r\n    try {\r\n\r\n        const config = {\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        }\r\n\r\n        const endpoint = variable.env === 'local' ? variable.endpointLocal : variable.endpointProd\r\n\r\n        const url  = `${endpoint}/api/dashboard/orders`\r\n\r\n        const { data } = await axios.post(`${url}`, body, config)\r\n\r\n        return {status: true, data}\r\n    } catch (error) {\r\n        const message = error.response && error.response.data.message\r\n                ? error.response.data.message\r\n                : error.message\r\n        \r\n        return {status: false, error: message}\r\n    }\r\n}\r\n\r\nexport const getChiffreAffaires = async (body) => {\r\n    try {\r\n\r\n        const config = {\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        }\r\n\r\n        const endpoint = variable.env === 'local' ? variable.endpointLocal : variable.endpointProd\r\n\r\n        const url  = `${endpoint}/api/dashboard/chiffres-affaires`\r\n\r\n        const { data } = await axios.post(`${url}`, body, config)\r\n\r\n        return {status: true, data}\r\n    } catch (error) {\r\n        const message = error.response && error.response.data.message\r\n                ? error.response.data.message\r\n                : error.message\r\n        \r\n        return {status: false, error: message}\r\n    }\r\n}","import React, { lazy, useState, useEffect } from \"react\";\n\nimport moment from \"moment\";\n\nimport {\n  CButton,\n  CButtonGroup,\n  CCard,\n  CCardBody,\n  CCardFooter,\n  CCol,\n  CProgress,\n  CRow,\n  CFormSelect,\n} from \"@coreui/react\";\nimport { CChartLine } from \"@coreui/react-chartjs\";\nimport { getStyle, hexToRgba } from \"@coreui/utils\";\nimport { Authentification } from \"../../components/index\";\n\nimport {\n  // getOrders,\n  getChiffreAffaires,\n  getDashboard,\n} from \"../../provider/dashboardFetch\";\n\nimport Loader from \"../../components/Loader\";\nimport Message from \"../../components/Message\";\n\nconst WidgetsDropdownCustom = lazy(() => import(\"../widgets/WidgetsDropdownCustom.js\"));\n// const WidgetsDropdown = lazy(() => import(\"../widgets/WidgetsDropdown.js\"));\n\nconst Dashboard = () => {\n  /** State */\n  const [footerStat, setFooterStat] = useState(null);\n  const [chiffreAffaires, setChiffreAffaires] = useState(null);\n  const [error, setError] = useState(null);\n  const [errorCA, setErrorCA] = useState(null);\n  const [type, setType] = useState(\"Day\");\n  const [status, setStatus] = useState(\"READING\");\n  const [labels, setLabels] = useState(null);\n  const [data, setData] = useState(null);\n\n  /** Run once, when the component mounts */\n  useEffect(() => {\n    console.log(\"Run once, when the component mounts\");\n\n    async function fetch() {\n      const resp = await getDashboard();\n      const resp_1 = await getChiffreAffaires();\n\n      resp?.status ? setFooterStat({ ...resp?.data }) : setError(resp?.error);\n      resp_1?.status\n        ? setChiffreAffaires({ ...resp_1?.data })\n        : setErrorCA(resp_1?.error);\n    }\n\n    fetch();\n  }, []);\n\n  useEffect(() => {\n    console.log(\"Dependency\");\n\n    let labelsTMP = [];\n    let dataTMP = [];\n    let dataGlobal = [];\n\n    if (type === \"Day\") {\n      if (chiffreAffaires?.ordersChiffresGroupedByDayStatus?.length)\n        dataGlobal = [...chiffreAffaires?.ordersChiffresGroupedByDayStatus];\n    } else if (type === \"Month\") {\n      if (chiffreAffaires?.ordersChiffresGroupedByMonthWithStatus?.length)\n        dataGlobal = [\n          ...chiffreAffaires?.ordersChiffresGroupedByMonthWithStatus,\n        ];\n    } else if (type === \"Year\") {\n      if (chiffreAffaires?.ordersChiffresGroupedByYearWithStatus?.length)\n        dataGlobal = [\n          ...chiffreAffaires?.ordersChiffresGroupedByYearWithStatus,\n        ];\n    }\n\n    if (dataGlobal?.length) {\n      for (const order of dataGlobal) {\n        if (status === order.status) {\n          if (type === \"Day\") {\n            labelsTMP = [\n              ...labelsTMP,\n              moment(order.updatedAt).format(\"DD/MM/YYYY\"),\n            ];\n            dataTMP = [...dataTMP, order.total];\n          } else if (type === \"Month\") {\n            labelsTMP = [\n              ...labelsTMP,\n              moment(order.updatedAt).format(\"MM/YYYY\"),\n            ];\n            dataTMP = [...dataTMP, order.total];\n          } else if (type === \"Year\") {\n            labelsTMP = [...labelsTMP, moment(order.updatedAt).format(\"YYYY\")];\n            dataTMP = [...dataTMP, order.total];\n          }\n        }\n      }\n\n      setData([...dataTMP]);\n      setLabels([...labelsTMP]);\n    }\n  }, [status, type, chiffreAffaires]);\n\n  const toggleType = (value, key) => {\n    if (key === \"status\") setStatus(value);\n    else if (key === \"type\") setType(value);\n  };\n  // console.log(\"chiffreAffaires\", chiffreAffaires);\n  // console.log(\"labels\", labels, data, type, status);\n\n  if (footerStat === null || chiffreAffaires === null) {\n    return <Loader />;\n  }\n\n  if (errorCA) {\n    return <Message> {errorCA}</Message>;\n  }\n\n  if (error) {\n    return <Message> {error}</Message>;\n  }\n\n  return (\n    <>\n      <Authentification />\n\n      <WidgetsDropdownCustom\n        countClient={footerStat.countClient}\n        countCommercant={footerStat.countCommercant}\n        countAdmin={footerStat.countAdmin}\n        countOrder={footerStat.countOrder}\n      />\n\n      {/* <WidgetsDropdown /> */}\n\n      <CCard className=\"mb-4\">\n        <CCardBody>\n          <CRow>\n            <CCol sm={5}>\n              <h4 id=\"traffic\" className=\"card-title mb-0\">\n                Commandes\n              </h4>\n              <div className=\"small text-medium-emphasis\">\n                {moment().format(\"DD/MMM/YYYY h:mm:ss A\")}\n              </div>\n            </CCol>\n            <CCol sm={7} className=\"d-none d-md-block\">\n              <CFormSelect\n                value={status}\n                aria-label=\"Status\"\n                className=\"float-end mb-1\"\n                onChange={(e) => {\n                  toggleType(e.target.value, \"status\");\n                }}\n              >\n                {[\n                  \"ORDER_STATUS_UNSPECIFIED\",\n                  \"CONFIRMED\",\n                  \"PENDING\",\n                  \"PENDING_MERCHANT_CONFIRMATION\",\n                  \"CANCELED\",\n                  \"FAILED\",\n                  \"DECLINED_BY_MERCHANT\",\n                  \"READING\",\n                ].map((value) => (\n                  <option value={value} key={value}>\n                    {value}\n                  </option>\n                ))}\n              </CFormSelect>\n              <CButtonGroup className=\"float-end me-3\">\n                {[\"Day\", \"Month\", \"Year\"].map((value) => (\n                  <CButton\n                    onClick={() => toggleType(value, \"type\")}\n                    color=\"outline-secondary\"\n                    key={value}\n                    className=\"mx-0\"\n                    active={value === type}\n                  >\n                    {value}\n                  </CButton>\n                ))}\n              </CButtonGroup>\n            </CCol>\n          </CRow>\n          <CChartLine\n            style={{ height: \"300px\", marginTop: \"40px\" }}\n            data={{\n              labels: labels !== null ? [...labels] : [],\n              datasets: [\n                {\n                  label: `Commandes par ${type}`,\n                  backgroundColor: hexToRgba(getStyle(\"--cui-info\"), 10),\n                  borderColor: getStyle(\"--cui-info\"),\n                  pointHoverBackgroundColor: getStyle(\"--cui-info\"),\n                  borderWidth: 2,\n                  data: data !== null ? [...data] : [],\n                  fill: true,\n                },\n              ],\n            }}\n            options={{\n              maintainAspectRatio: false,\n              plugins: {\n                legend: {\n                  display: false,\n                },\n              },\n              scales: {\n                x: {\n                  grid: {\n                    drawOnChartArea: false,\n                  },\n                },\n                y: {\n                  ticks: {\n                    beginAtZero: true,\n                    maxTicksLimit: 5,\n                    // stepSize: Math.ceil(250 / 5),\n                    // max: 250,\n                  },\n                },\n              },\n              elements: {\n                line: {\n                  tension: 0.4,\n                },\n                point: {\n                  height: 5,\n                  radius: 5,\n                  hitRadius: 10,\n                  hoverRadius: 4,\n                  hoverBorderWidth: 3,\n                },\n              },\n            }}\n          />\n        </CCardBody>\n        <CCardFooter>\n          <CRow xs={{ cols: 1 }} md={{ cols: 5 }} className=\"text-center\">\n            {footerStat.orderStat.map((item, index) => (\n              <CCol className=\"mb-sm-2 mb-0\" key={index}>\n                <div className=\"text-medium-emphasis\">{item.title}</div>\n                <strong>\n                  {item.value} ({item.percent}%)\n                </strong>\n                <CProgress\n                  thin\n                  className=\"mt-2\"\n                  color={item.color}\n                  value={item?.percent ? Number(item?.percent) : 0}\n                />\n              </CCol>\n            ))}\n          </CRow>\n        </CCardFooter>\n      </CCard>\n    </>\n  );\n};\n\nexport default Dashboard;\n"],"sourceRoot":""}