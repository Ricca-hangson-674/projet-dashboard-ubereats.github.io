{"version":3,"sources":["views/discoveryTable/AjoutDiscoveryTable.js","configs/variable.js","components/Message.js","provider/discoveryTableFetch.js"],"names":["schemaUser","yup","shape","code","required","AjoutDiscoverytable","useState","message","setMessage","success","setSuccess","error","setError","history","useHistory","idRestaurant","useParams","paramQuery","window","location","hash","paramsJS","URLSearchParams","substring","lastIndexOf","d","has","get","console","log","useForm","resolver","yupResolver","mode","register","handleSubmit","formState","errors","isSubmitting","isValid","setValue","useEffect","fetch","a","getDiscoveryTables","resp","status","data","description","onSubmit","tmp","id","updateDiscoverytable","xs","classcode","sm","color","onClick","push","md","htmlFor","type","invalid","className","variable","env","endpointLocal","endpointProd","endpointFront","Message","variant","children","defaultProps","idDiscoveryTable","config","headers","endpoint","url","axios","response","body","post","put"],"mappings":"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","file":"static/js/28.3df9ae2a.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  CCard,\r\n  CCardBody,\r\n  CCardHeader,\r\n  CCol,\r\n  CRow,\r\n  CForm,\r\n  CButton,\r\n  CFormLabel,\r\n  CFormInput,\r\n  CFormFeedback,\r\n  CButtonGroup,\r\n} from \"@coreui/react\";\r\n\r\nimport { Authentification } from \"../../components/index\";\r\n\r\nimport { useForm } from \"react-hook-form\";\r\nimport { yupResolver } from \"@hookform/resolvers/yup\";\r\nimport * as yup from \"yup\";\r\n\r\nimport { useHistory, useParams } from \"react-router-dom\";\r\n\r\nimport Message from \"../../components/Message\";\r\n\r\nimport {\r\n    getDiscoveryTables,\r\n    updateDiscoverytable,\r\n} from '../../provider/discoveryTableFetch'\r\n\r\nconst schemaUser = yup.object().shape({\r\n  code: yup.string().required(\"code is required\"),\r\n});\r\n\r\nconst AjoutDiscoverytable = () => {\r\n  /** State */\r\n  const [message, setMessage] = useState(null);\r\n  const [success, setSuccess] = useState(false);\r\n  const [error, setError] = useState(false);\r\n\r\n  /** Hook Route */\r\n  let history = useHistory();\r\n  let { idRestaurant } = useParams();\r\n  const paramQuery = window.location.hash;\r\n  const paramsJS = new URLSearchParams(\r\n    paramQuery.substring(paramQuery.lastIndexOf(\"?\"))\r\n  );\r\n  const d = paramsJS.has(\"d\")\r\n    ? paramsJS.get(\"d\")\r\n    : \"discoverytable\";\r\n\r\n  console.log(\r\n    \"params\",\r\n    paramQuery.substring(paramQuery.lastIndexOf(\"?\")),\r\n    d\r\n  );\r\n\r\n  /** Form Hook */\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: { errors, isSubmitting, isValid },\r\n    // resetField,\r\n    setValue,\r\n  } = useForm({\r\n    resolver: yupResolver(schemaUser),\r\n    mode: \"onTouched\",\r\n  });\r\n\r\n  /** Run once, when the component mounts */\r\n  useEffect(() => {\r\n    console.log(\"Run once, when the component mounts\");\r\n\r\n    if (d) {\r\n      async function fetch() {\r\n        const resp = await getDiscoveryTables(idRestaurant, d);\r\n\r\n        if (resp?.status) {\r\n          setValue(\"code\", resp?.data.code);\r\n          setValue(\"description\", resp?.data.description);\r\n        } else {\r\n          setMessage(resp?.error);\r\n        }\r\n      }\r\n\r\n      fetch();\r\n    }\r\n  }, [d, setValue, idRestaurant]);\r\n\r\n  const onSubmit = async (data) => {\r\n    let resp = null;\r\n\r\n    console.log('onSubmit', data)\r\n\r\n    if (isValid) {\r\n      /** reste */\r\n      setSuccess(false);\r\n      setError(false);\r\n\r\n      if (d !== 'default') {\r\n        const tmp = {id: d, mode: \"update\"}\r\n        resp = await updateDiscoverytable(idRestaurant, {...data, ...tmp}, 'update');\r\n      } else {\r\n        resp = await updateDiscoverytable(idRestaurant, data);\r\n      }\r\n      \r\n\r\n      if (resp?.status) {\r\n        /** Reset */\r\n        // resetField(\"code\");\r\n        // resetField(\"description\");\r\n\r\n        setSuccess(true);\r\n      } else {\r\n        setError(true);\r\n        setMessage(resp?.error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const back = () => {\r\n    history.push(`/discovery-table/${idRestaurant}`);\r\n  };\r\n\r\n  return (\r\n    <CRow>\r\n      <Authentification />\r\n      {error && <Message> {message}</Message>}\r\n      {success && <Message> {`Success Ajout ou Edite`}</Message>}\r\n      <CCol xs={12}>\r\n        <CCard classcode=\"mb-4\">\r\n          <CCardHeader>\r\n            <CRow>\r\n              <CCol sm={5}>\r\n                <strong> { d ? 'Edit' : 'Ajout'} Discoverytable</strong>\r\n              </CCol>\r\n              <CCol sm={7}>\r\n                <CButtonGroup classcode=\"float-end me-3\">\r\n                  <CButton\r\n                    color=\"outline-secondary\"\r\n                    classcode=\"mx-0\"\r\n                    onClick={() => back()}\r\n                  >\r\n                    Retour\r\n                  </CButton>\r\n                </CButtonGroup>\r\n              </CCol>\r\n            </CRow>\r\n          </CCardHeader>\r\n          <CCardBody>\r\n            <CForm\r\n              classcode={`row g-3 needs-validation ${\r\n                isValid && \"was-validated\"\r\n              }`}\r\n              onSubmit={handleSubmit(onSubmit)}\r\n            >\r\n              <CCol md={6}>\r\n                <CFormLabel htmlFor=\"code\">code</CFormLabel>\r\n                <CFormInput\r\n                  type=\"text\"\r\n                  id=\"code\"\r\n                  required\r\n                  {...register(\"code\")}\r\n                />\r\n                <CFormFeedback invalid>{errors.code?.message}</CFormFeedback>\r\n              </CCol>\r\n              <CCol xs={12}>\r\n                <CButton\r\n                  color=\"primary\"\r\n                  type=\"submit\"\r\n                  className={`mt-2 ${isSubmitting ? \"disabled\" : \" \"}`}\r\n                >\r\n                  Submit\r\n                </CButton>\r\n              </CCol>\r\n            </CForm>\r\n          </CCardBody>\r\n        </CCard>\r\n      </CCol>\r\n    </CRow>\r\n  );\r\n};\r\nexport default AjoutDiscoverytable;\r\n","export const variable = {\r\n    env: 'prod', // local | prod\r\n    endpointLocal: 'http://127.0.0.1:5059',\r\n    endpointProd:'https://projet-eats-nrh.herokuapp.com',\r\n    endpointFront:'http://localhost:3232',\r\n}","import React from 'react'\r\nimport {CAlert} from '@coreui/react'\r\n\r\nconst Message = ({variant, children}) => {\r\n    return <CAlert color={variant}>\r\n        { children }\r\n    </CAlert>\r\n}\r\n\r\nMessage.defaultProps = {\r\n    variant: 'info'\r\n}\r\n\r\nexport default Message\r\n","import axios from 'axios'\r\nimport { variable } from '../configs/variable'\r\n\r\nexport const getDiscoveryTables = async (\r\n  idRestaurant = null,\r\n  idDiscoveryTable = null\r\n) => {\r\n  try {\r\n    const config = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    }\r\n\r\n    const endpoint =\r\n      variable.env === 'local' ? variable.endpointLocal : variable.endpointProd\r\n\r\n    const url = idDiscoveryTable\r\n      ? `${endpoint}/api/restaurants/${idRestaurant}/discoverytable?id=${idDiscoveryTable}`\r\n      : `${endpoint}/api/restaurants/${idRestaurant}/discoverytable`\r\n\r\n    const { data } = await axios.get(`${url}`, config)\r\n\r\n    return { status: true, data }\r\n  } catch (error) {\r\n    const message =\r\n      error.response && error.response.data.message\r\n        ? error.response.data.message\r\n        : error.message\r\n\r\n    return { status: false, error: message }\r\n  }\r\n}\r\n\r\nexport const updateDiscoverytable = async (\r\n  idRestaurant,\r\n  body,\r\n  mode = 'post'\r\n) => {\r\n  try {\r\n    const config = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    }\r\n\r\n    const endpoint =\r\n      variable.env === 'local' ? variable.endpointLocal : variable.endpointProd\r\n\r\n    let data = null\r\n\r\n    if (mode === 'post') {\r\n      data = await axios.post(\r\n        `${endpoint}/api/restaurants/${idRestaurant}/discoverytable`,\r\n        body,\r\n        config\r\n      )\r\n    } else if (mode === 'update') {\r\n      data = await axios.put(\r\n        `${endpoint}/api/restaurants/${idRestaurant}/discoverytable`,\r\n        body,\r\n        config\r\n      )\r\n    }\r\n\r\n    console.log('data', data)\r\n\r\n    return { status: true, data }\r\n  } catch (error) {\r\n    const message =\r\n      error.response && error.response.data.message\r\n        ? error.response.data.message\r\n        : error.message\r\n\r\n    return { status: false, error: message }\r\n  }\r\n}\r\n"],"sourceRoot":""}