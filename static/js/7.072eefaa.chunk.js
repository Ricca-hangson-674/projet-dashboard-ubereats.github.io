(this["webpackJsonpprojet-uber-eats-dashboard"]=this["webpackJsonpprojet-uber-eats-dashboard"]||[]).push([[7],{553:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={env:"prod",endpointLocal:"http://127.0.0.1:5059",endpointProd:"https://projet-eats-nrh.herokuapp.com"}},554:function(e,t,n){"use strict";n(0);var a=n(4),r=n(2),o=function(e){var t=e.variant,n=e.children;return Object(r.jsx)(a.a,{color:t,children:n})};o.defaultProps={variant:"info"},t.a=o},557:function(e,t,n){"use strict";n(0);var a=n(4),r=n(2);t.a=function(){return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(a.U,{color:"primary",children:Object(r.jsx)("span",{className:"sr-only",children:"Loading ..."})})})}},602:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var a=n(551),r=n.n(a),o=n(552),s=n(556),i=n.n(s),c=n(553),l=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n,a,o,s,l,u,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===c.a.env?c.a.endpointLocal:c.a.endpointProd,o=t?"".concat(a,"/api/categories/").concat(t):"".concat(a,"/api/categories"),e.next=7,i.a.get("".concat(o),n);case 7:return s=e.sent,l=s.data,e.abrupt("return",{status:!0,data:l});case 12:return e.prev=12,e.t0=e.catch(1),u=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:u});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,s,l,u,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:null,e.prev=1,o={headers:{"Content-Type":"application/json"}},s="local"===c.a.env?c.a.endpointLocal:c.a.endpointProd,l=null,!n){e.next=11;break}return e.next=8,i.a.put("".concat(s,"/api/categories/").concat(n),t,o);case 8:l=e.sent,e.next=14;break;case 11:return e.next=13,i.a.post("".concat(s,"/api/categories"),t,o);case 13:l=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=l)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),u=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:u});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()},603:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var a=n(551),r=n.n(a),o=n(552),s=n(556),i=n.n(s),c=n(553),l=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n,a,o,s,l,u,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===c.a.env?c.a.endpointLocal:c.a.endpointProd,o=t?"".concat(a,"/api/optionLists/").concat(t):"".concat(a,"/api/optionLists"),e.next=7,i.a.get("".concat(o),n);case 7:return s=e.sent,l=s.data,e.abrupt("return",{status:!0,data:l});case 12:return e.prev=12,e.t0=e.catch(1),u=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:u});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,s,l,u,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:null,e.prev=1,o={headers:{"Content-Type":"application/json"}},s="local"===c.a.env?c.a.endpointLocal:c.a.endpointProd,l=null,!n){e.next=11;break}return e.next=8,i.a.put("".concat(s,"/api/optionLists/").concat(n),t,o);case 8:l=e.sent,e.next=14;break;case 11:return e.next=13,i.a.post("".concat(s,"/api/optionLists"),t,o);case 13:l=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=l)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),u=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:u});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()},800:function(e,t,n){"use strict";n.r(t);var a=n(572),r=n(28),o=n(551),s=n.n(o),i=n(559),c=n(552),l=n(555),u=n(0),d=n(4),p=n(639),j=n(174),b=n(563),v=n(570),h=n(568),m=n(26),f=n(52),x=n(554),O=n(557),g=n(556),y=n.n(g),L=n(553),k=function(){var e=Object(c.a)(s.a.mark((function e(){var t,n,a,r,o,i,c,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===L.a.env?L.a.endpointLocal:L.a.endpointProd,r=t?"".concat(a,"/api/foods/").concat(t):"".concat(a,"/api/foods"),e.next=7,y.a.get("".concat(r),n);case 7:return o=e.sent,i=o.data,e.abrupt("return",{status:!0,data:i});case 12:return e.prev=12,e.t0=e.catch(1),c=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:c});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(c.a)(s.a.mark((function e(t){var n,a,r,o,i,c,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:null,e.prev=1,r={headers:{"Content-Type":"application/json"}},o="local"===L.a.env?L.a.endpointLocal:L.a.endpointProd,i=null,!n){e.next=11;break}return e.next=8,y.a.put("".concat(o,"/api/foods/").concat(n),t,r);case 8:i=e.sent,e.next=14;break;case 11:return e.next=13,y.a.post("".concat(o,"/api/foods"),t,r);case 13:i=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=i)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),c=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:c});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}(),P=n(603),C=n(602),S=n(2),q=h.d().shape({name:h.f().required("name is required"),description:h.f().required("description is required"),price:h.c().typeError("price must be a `number` type").required("price are required"),category:h.f().required("categorie are required"),optionLists:h.a(),isPopular:h.b(),available:h.b(),promotion:h.b()});t.default=function(){var e,t,n,o,h,g,y,L=Object(u.useState)(null),D=Object(l.a)(L,2),F=D[0],N=D[1],A=Object(u.useState)(!1),T=Object(l.a)(A,2),V=T[0],_=T[1],E=Object(u.useState)(!1),z=Object(l.a)(E,2),B=z[0],R=z[1],I=Object(u.useState)(null),J=Object(l.a)(I,2),U=J[0],M=J[1],G=Object(u.useState)(null),H=Object(l.a)(G,2),K=H[0],Q=H[1],W=Object(m.g)(),X=Object(m.i)().id,Y=window.location.hash,Z=new URLSearchParams(Y.substring(Y.lastIndexOf("?"))),$=Z.has("restaurant")?Z.get("restaurant"):"restaurant",ee=Z.has("category")?Z.get("category"):"category",te=Z.has("optionLists")?Z.get("optionLists"):[];console.log("params",Y.substring(Y.lastIndexOf("?")),ee,te,$);var ne=Object(b.e)({resolver:Object(v.a)(q),mode:"onTouched",defaultValues:{priceDrop:0}}),ae=ne.register,re=ne.handleSubmit,oe=ne.formState,se=oe.errors,ie=oe.isSubmitting,ce=oe.isValid,le=ne.resetField,ue=ne.setValue,de=ne.control;Object(u.useEffect)((function(){function e(){return(e=Object(c.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(P.b)(null,null);case 2:return t=e.sent,e.next=5,Object(C.b)(null,null);case 5:n=e.sent,(null===t||void 0===t?void 0:t.status)?Q(Object(i.a)(t.data.map((function(e){return{value:e._id,label:e.name}})))):N(null===t||void 0===t?void 0:t.error),(null===n||void 0===n?void 0:n.status)?M(Object(i.a)(n.data)):N(null===n||void 0===n?void 0:n.error);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}console.log("Run once, when the component mounts "),function(){e.apply(this,arguments)}()}),[]),Object(u.useEffect)((function(){if(console.log("useEffect, Dependency"),X){var e=function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(null,null);case 2:(null===(t=e.sent)||void 0===t?void 0:t.status)?(ue("name",null===t||void 0===t?void 0:t.data.name),ue("description",null===t||void 0===t?void 0:t.data.description),ue("price",null===t||void 0===t?void 0:t.data.price),ue("priceDrop",null===t||void 0===t?void 0:t.data.priceDrop),ue("category",null===t||void 0===t?void 0:t.data.category),ue("optionLists",null===t||void 0===t?void 0:t.data.optionLists),ue("isPopular",null===t||void 0===t?void 0:t.data.isPopular),ue("available",null===t||void 0===t?void 0:t.data.available),ue("promotion",null===t||void 0===t?void 0:t.data.promotion)):N(null===t||void 0===t?void 0:t.error);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[X,ue]);var pe=function(){var e=Object(c.a)(s.a.mark((function e(t){var n,o,i,c,l,u,d,p,j,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null,i=null,(null===t||void 0===t?void 0:t.optionLists)?(null===t||void 0===t||null===(c=t.optionLists)||void 0===c?void 0:c.length)&&(i=Object(r.a)(Object(r.a)({},t),{},{optionLists:t.optionLists.map((function(e){return e.value}))})):(console.log("body",i),i=Object(r.a)({},t)),console.log("onSubmit",t,i),!ce||!i){e.next=10;break}return _(!1),R(!1),e.next=9,w(i,X);case 9:o=e.sent;case 10:if(!(null===(n=o)||void 0===n?void 0:n.status)){e.next=47;break}if(le("name"),le("description"),le("price"),le("priceDrop"),le("category"),le("optionLists"),le("isPopular"),le("available"),le("promotion"),!i.category){e.next=24;break}if(!$){e.next=24;break}return e.next=24,Object(C.a)({restaurant:$},i.category);case 24:if(!i.optionLists){e.next=44;break}if(!i.optionLists.length){e.next=44;break}l=Object(a.a)(i.optionLists),e.prev=27,l.s();case 29:if((u=l.n()).done){e.next=36;break}return j=u.value,console.log("optionListFor",j),e.next=34,Object(P.a)({foods:[null===(d=o)||void 0===d||null===(p=d.data)||void 0===p?void 0:p._id]},j);case 34:e.next=29;break;case 36:e.next=41;break;case 38:e.prev=38,e.t0=e.catch(27),l.e(e.t0);case 41:return e.prev=41,l.f(),e.finish(41);case 44:_(!0),e.next=49;break;case 47:R(!0),N(null===(b=o)||void 0===b?void 0:b.error);case 49:case"end":return e.stop()}}),e,null,[[27,38,41,44]])})));return function(t){return e.apply(this,arguments)}}();return null===U||null===K?Object(S.jsx)(O.a,{}):(console.log("errors",se),Object(S.jsxs)(d.P,{children:[Object(S.jsx)(j.f,{}),B&&Object(S.jsxs)(x.a,{children:[" ",F]}),V&&Object(S.jsxs)(x.a,{children:[" ","Success Ajout ou Edite"]}),Object(S.jsx)(d.o,{xs:12,children:Object(S.jsxs)(d.h,{className:"mb-4",children:[Object(S.jsx)(d.l,{children:Object(S.jsxs)(d.P,{children:[Object(S.jsx)(d.o,{sm:5,children:Object(S.jsx)("strong",{children:"Ajout Food"})}),Object(S.jsx)(d.o,{sm:7,children:Object(S.jsx)(d.g,{className:"float-end me-3",children:Object(S.jsx)(d.f,{color:"outline-secondary",className:"mx-0",onClick:function(){W.push("/restaurants")},children:"Retour"})})})]})}),Object(S.jsx)(d.i,{children:Object(S.jsxs)(d.x,{noValidate:!0,className:"row g-3",onSubmit:re(pe),children:[Object(S.jsxs)(d.o,{md:6,children:[Object(S.jsx)(d.A,{htmlFor:"name",children:"Name"}),Object(S.jsx)(d.z,Object(r.a)(Object(r.a)({type:"text",id:"name",required:!0},ae("name")),{},{invalid:!!se.name})),Object(S.jsx)(d.y,{invalid:!0,children:null===(e=se.name)||void 0===e?void 0:e.message})]}),Object(S.jsxs)(d.o,{md:6,children:[Object(S.jsx)(d.A,{htmlFor:"lastName",children:"Description"}),Object(S.jsx)(d.z,Object(r.a)(Object(r.a)({type:"text",id:"description",required:!0},ae("description")),{},{invalid:!!se.description})),Object(S.jsx)(d.y,{invalid:!0,children:null===(t=se.description)||void 0===t?void 0:t.message})]}),Object(S.jsxs)(d.o,{md:6,children:[Object(S.jsx)(d.A,{htmlFor:"price",children:"Price"}),Object(S.jsx)(d.z,Object(r.a)(Object(r.a)({type:"number",id:"price",required:!0},ae("price")),{},{invalid:!!se.price})),Object(S.jsx)(d.y,{invalid:!0,children:null===(n=se.price)||void 0===n?void 0:n.message})]}),Object(S.jsxs)(d.o,{md:6,children:[Object(S.jsx)(d.A,{htmlFor:"priceDrop",children:"PriceDrop"}),Object(S.jsx)(d.z,Object(r.a)({type:"number",id:"priceDrop"},ae("priceDrop"))),Object(S.jsx)(d.y,{invalid:!0,children:null===(o=se.priceDrop)||void 0===o?void 0:o.message})]}),Object(S.jsx)(d.o,{md:3,children:Object(S.jsx)(d.C,Object(r.a)({label:"isPopular",id:"isPopular"},ae("isPopular")))}),Object(S.jsx)(d.o,{md:3,children:Object(S.jsx)(d.C,Object(r.a)({label:"available",id:"available"},ae("available")))}),Object(S.jsx)(d.o,{md:3,children:Object(S.jsx)(d.C,Object(r.a)({label:"promotion",id:"promotion"},ae("promotion")))}),Object(S.jsxs)(d.o,{md:6,children:[Object(S.jsx)(d.A,{htmlFor:"categorie",children:"Categorie"}),Object(S.jsx)(d.B,Object(r.a)(Object(r.a)({"aria-label":"Categorie",id:"categorie",required:!0},ae("category")),{},{invalid:!!se.category,defaultValue:(null===(h=U[0])||void 0===h?void 0:h._id)&&(null===(g=U[0])||void 0===g?void 0:g._id),children:(null===U||void 0===U?void 0:U.length)&&U.map((function(e){return Object(S.jsx)("option",{value:e._id,children:e.name},e._id)}))})),Object(S.jsx)(d.y,{invalid:!0,children:null===(y=se.category)||void 0===y?void 0:y.message}),Object(S.jsxs)("small",{className:"form-text text-muted",children:[Object(S.jsx)(f.b,{to:"/ajout-categorie?restaurant=".concat($),children:"Ajouter une categorie"})," "]})]}),Object(S.jsxs)(d.o,{md:6,children:[Object(S.jsx)(d.A,{htmlFor:"optionLists",children:"Option Liste"}),Object(S.jsx)(b.a,{control:de,name:"optionLists",render:function(e){var t,n,a=e.field,r=a.onChange,o=a.onBlur,s=a.value,i=a.name;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(p.a,{defaultValue:s,value:s,name:i,onBlur:o,onChange:r,isMulti:!0,options:K}),Object(S.jsxs)("small",{className:"form-text text-muted",children:[Object(S.jsx)(f.b,{to:"/ajout-optionList?foods=".concat("foods","&options=","options"),children:"Ajouter un option Liste"})," "]}),(null===(t=se.optionLists)||void 0===t?void 0:t.message)&&Object(S.jsx)("div",{style:{display:"block"},className:"invalid-feedback",children:null===(n=se.optionLists)||void 0===n?void 0:n.message})]})}})]}),Object(S.jsx)(d.o,{xs:12,children:Object(S.jsx)(d.f,{color:"primary",type:"submit",className:ie?"disabled":" ",children:"Submit"})})]})})]})})]}))}}}]);
//# sourceMappingURL=7.072eefaa.chunk.js.map