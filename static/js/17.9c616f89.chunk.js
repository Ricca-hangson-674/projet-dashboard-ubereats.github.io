(this["webpackJsonpprojet-uber-eats-dashboard"]=this["webpackJsonpprojet-uber-eats-dashboard"]||[]).push([[17],{552:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={env:"prod",endpointLocal:"http://127.0.0.1:5059",endpointProd:"https://projet-eats-nrh.herokuapp.com"}},553:function(e,t,n){"use strict";n(0);var a=n(4),r=n(2),o=function(e){var t=e.variant,n=e.children;return Object(r.jsx)(a.a,{color:t,children:n})};o.defaultProps={variant:"info"},t.a=o},601:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var a=n(550),r=n.n(a),o=n(551),s=n(555),i=n.n(s),c=n(552),u=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n,a,o,s,u,l,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===c.a.env?c.a.endpointLocal:c.a.endpointProd,o=t?"".concat(a,"/api/categories/").concat(t):"".concat(a,"/api/categories"),e.next=7,i.a.get("".concat(o),n);case 7:return s=e.sent,u=s.data,e.abrupt("return",{status:!0,data:u});case 12:return e.prev=12,e.t0=e.catch(1),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:l});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,s,u,l,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:null,e.prev=1,o={headers:{"Content-Type":"application/json"}},s="local"===c.a.env?c.a.endpointLocal:c.a.endpointProd,u=null,!n){e.next=11;break}return e.next=8,i.a.put("".concat(s,"/api/categories/").concat(n),t,o);case 8:u=e.sent,e.next=14;break;case 11:return e.next=13,i.a.post("".concat(s,"/api/categories"),t,o);case 13:u=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=u)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:l});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()},602:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var a=n(550),r=n.n(a),o=n(551),s=n(555),i=n.n(s),c=n(552),u=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n,a,o,s,u,l,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===c.a.env?c.a.endpointLocal:c.a.endpointProd,o=t?"".concat(a,"/api/optionLists/").concat(t):"".concat(a,"/api/optionLists"),e.next=7,i.a.get("".concat(o),n);case 7:return s=e.sent,u=s.data,e.abrupt("return",{status:!0,data:u});case 12:return e.prev=12,e.t0=e.catch(1),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:l});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,s,u,l,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:null,e.prev=1,o={headers:{"Content-Type":"application/json"}},s="local"===c.a.env?c.a.endpointLocal:c.a.endpointProd,u=null,!n){e.next=11;break}return e.next=8,i.a.put("".concat(s,"/api/optionLists/").concat(n),t,o);case 8:u=e.sent,e.next=14;break;case 11:return e.next=13,i.a.post("".concat(s,"/api/optionLists"),t,o);case 13:u=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=u)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:l});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()},799:function(e,t,n){"use strict";n.r(t);var a=n(571),r=n(28),o=n(550),s=n.n(o),i=n(558),c=n(551),u=n(554),l=n(0),d=n(4),p=n(638),j=n(174),b=n(562),v=n(569),h=n(567),m=n(26),x=n(52),f=n(553),O=n(555),g=n.n(O),y=n(552),L=function(){var e=Object(c.a)(s.a.mark((function e(){var t,n,a,r,o,i,c,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===y.a.env?y.a.endpointLocal:y.a.endpointProd,r=t?"".concat(a,"/api/foods/").concat(t):"".concat(a,"/api/foods"),e.next=7,g.a.get("".concat(r),n);case 7:return o=e.sent,i=o.data,e.abrupt("return",{status:!0,data:i});case 12:return e.prev=12,e.t0=e.catch(1),c=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:c});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(c.a)(s.a.mark((function e(t){var n,a,r,o,i,c,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:null,e.prev=1,r={headers:{"Content-Type":"application/json"}},o="local"===y.a.env?y.a.endpointLocal:y.a.endpointProd,i=null,!n){e.next=11;break}return e.next=8,g.a.put("".concat(o,"/api/foods/").concat(n),t,r);case 8:i=e.sent,e.next=14;break;case 11:return e.next=13,g.a.post("".concat(o,"/api/foods"),t,r);case 13:i=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=i)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),c=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:c});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}(),w=n(602),P=n(601),C=n(2),S=h.object().shape({name:h.string().required("name is required"),description:h.string().required("description is required"),price:h.number().required("price are required"),priceDrop:h,category:h.string().required("categorie are required"),optionLists:h.array(),isPopular:h.boolean(),available:h.boolean(),promotion:h.boolean()});t.default=function(){var e,t,n,o,h,O=Object(l.useState)(null),g=Object(u.a)(O,2),y=g[0],q=g[1],D=Object(l.useState)(!1),A=Object(u.a)(D,2),F=A[0],N=A[1],T=Object(l.useState)(!1),V=Object(u.a)(T,2),z=V[0],E=V[1],_=Object(l.useState)(null),B=Object(u.a)(_,2),R=B[0],I=B[1],J=Object(l.useState)([]),M=Object(u.a)(J,2),U=M[0],G=M[1],H=Object(m.g)(),K=Object(m.i)().id,Q=window.location.hash,W=new URLSearchParams(Q.substring(Q.lastIndexOf("?"))),X=W.has("restaurant")?W.get("restaurant"):"restaurant",Y=W.has("category")?W.get("category"):"category",Z=W.has("optionLists")?W.get("optionLists"):[];console.log("params",Q.substring(Q.lastIndexOf("?")),Y,Z,X);var $=Object(b.e)({resolver:Object(v.a)(S),mode:"onTouched",defaultValues:{priceDrop:0}}),ee=$.register,te=$.handleSubmit,ne=$.formState,ae=ne.errors,re=ne.isSubmitting,oe=ne.isValid,se=$.resetField,ie=$.setValue,ce=$.control;Object(l.useEffect)((function(){function e(){return(e=Object(c.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.b)(null,null);case 2:return t=e.sent,e.next=5,Object(P.b)(null,null);case 5:n=e.sent,(null===t||void 0===t?void 0:t.status)?G(Object(i.a)(t.data.map((function(e){return{value:e._id,label:e.name}})))):q(null===t||void 0===t?void 0:t.error),(null===n||void 0===n?void 0:n.status)?I(Object(i.a)(n.data)):q(null===n||void 0===n?void 0:n.error);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}console.log("Run once, when the component mounts "),function(){e.apply(this,arguments)}()}),[]),Object(l.useEffect)((function(){if(console.log("useEffect, Dependency"),K){var e=function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(null,null);case 2:(null===(t=e.sent)||void 0===t?void 0:t.status)?(ie("name",null===t||void 0===t?void 0:t.data.name),ie("description",null===t||void 0===t?void 0:t.data.description),ie("price",null===t||void 0===t?void 0:t.data.price),ie("priceDrop",null===t||void 0===t?void 0:t.data.priceDrop),ie("category",null===t||void 0===t?void 0:t.data.category),ie("optionLists",null===t||void 0===t?void 0:t.data.optionLists),ie("isPopular",null===t||void 0===t?void 0:t.data.isPopular),ie("available",null===t||void 0===t?void 0:t.data.available),ie("promotion",null===t||void 0===t?void 0:t.data.promotion)):q(null===t||void 0===t?void 0:t.error);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[K,ie]);var ue=function(){var e=Object(c.a)(s.a.mark((function e(t){var n,o,i,c,u,l,d,p,j,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null,c=null,c=(null===t||void 0===t?void 0:t.optionLists)&&(null===t||void 0===t||null===(n=t.optionLists)||void 0===n?void 0:n.length)?Object(r.a)(Object(r.a)({},t),{},{optionLists:t.optionLists.map((function(e){return e.value}))}):Object(r.a)({},t),console.log("onSubmit",t,c),!oe){e.next=10;break}return N(!1),E(!1),e.next=9,k(c,K);case 9:i=e.sent;case 10:if(!(null===(o=i)||void 0===o?void 0:o.status)){e.next=46;break}if(se("name"),se("description"),se("price"),se("priceDrop"),se("category"),se("optionLists"),se("isPopular"),se("available"),se("promotion"),!c.category){e.next=24;break}if(!X){e.next=24;break}return e.next=24,Object(P.a)({restaurant:X},c.category);case 24:if(!c.optionLists.length){e.next=43;break}u=Object(a.a)(c.optionLists),e.prev=26,u.s();case 28:if((l=u.n()).done){e.next=35;break}return j=l.value,console.log("optionListFor",j),e.next=33,Object(w.a)({foods:[null===(d=i)||void 0===d||null===(p=d.data)||void 0===p?void 0:p._id]},j);case 33:e.next=28;break;case 35:e.next=40;break;case 37:e.prev=37,e.t0=e.catch(26),u.e(e.t0);case 40:return e.prev=40,u.f(),e.finish(40);case 43:N(!0),e.next=48;break;case 46:E(!0),q(null===(b=i)||void 0===b?void 0:b.error);case 48:case"end":return e.stop()}}),e,null,[[26,37,40,43]])})));return function(t){return e.apply(this,arguments)}}();return console.log("errors",ae),Object(C.jsxs)(d.P,{children:[Object(C.jsx)(j.f,{}),z&&Object(C.jsxs)(f.a,{children:[" ",y]}),F&&Object(C.jsxs)(f.a,{children:[" ","Success Ajout ou Edite"]}),Object(C.jsx)(d.o,{xs:12,children:Object(C.jsxs)(d.h,{className:"mb-4",children:[Object(C.jsx)(d.l,{children:Object(C.jsxs)(d.P,{children:[Object(C.jsx)(d.o,{sm:5,children:Object(C.jsx)("strong",{children:"Ajout Food"})}),Object(C.jsx)(d.o,{sm:7,children:Object(C.jsx)(d.g,{className:"float-end me-3",children:Object(C.jsx)(d.f,{color:"outline-secondary",className:"mx-0",onClick:function(){H.push("/restaurants")},children:"Retour"})})})]})}),Object(C.jsx)(d.i,{children:Object(C.jsxs)(d.x,{noValidate:!0,className:"row g-3",onSubmit:te(ue),children:[Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"name",children:"Name"}),Object(C.jsx)(d.z,Object(r.a)({type:"text",id:"name",required:!0},ee("name"))),Object(C.jsx)(d.y,{invalid:!0,children:null===(e=ae.name)||void 0===e?void 0:e.message})]}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"lastName",children:"Description"}),Object(C.jsx)(d.z,Object(r.a)({type:"text",id:"description",required:!0},ee("description"))),Object(C.jsx)(d.y,{invalid:!0,children:null===(t=ae.description)||void 0===t?void 0:t.message})]}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"price",children:"Price"}),Object(C.jsx)(d.z,Object(r.a)({type:"number",id:"price",required:!0},ee("price"))),Object(C.jsx)(d.y,{invalid:!0,children:null===(n=ae.price)||void 0===n?void 0:n.message})]}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"priceDrop",children:"PriceDrop"}),Object(C.jsx)(d.z,Object(r.a)({type:"number",id:"priceDrop"},ee("priceDrop"))),Object(C.jsx)(d.y,{invalid:!0,children:null===(o=ae.priceDrop)||void 0===o?void 0:o.message})]}),Object(C.jsx)(d.o,{md:3,children:Object(C.jsx)(d.C,Object(r.a)({label:"isPopular",id:"isPopular"},ee("isPopular")))}),Object(C.jsx)(d.o,{md:3,children:Object(C.jsx)(d.C,Object(r.a)({label:"available",id:"available"},ee("available")))}),Object(C.jsx)(d.o,{md:3,children:Object(C.jsx)(d.C,Object(r.a)({label:"promotion",id:"promotion"},ee("promotion")))}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"categorie",children:"Categorie"}),Object(C.jsx)(d.B,Object(r.a)(Object(r.a)({"aria-label":"Categorie",id:"categorie",required:!0},ee("category")),{},{children:(null===R||void 0===R?void 0:R.length)&&R.map((function(e){return Object(C.jsx)("option",{value:e._id,children:e.name},e._id)}))})),Object(C.jsx)(d.y,{invalid:!0,children:null===(h=ae.category)||void 0===h?void 0:h.message}),Object(C.jsxs)("small",{className:"form-text text-muted",children:[Object(C.jsx)(x.b,{to:"/ajout-categorie?restaurant=".concat(X),children:"Ajouter une categorie"})," "]})]}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"optionLists",children:"Option Liste"}),Object(C.jsx)(b.a,{control:ce,name:"optionLists",render:function(e){var t,n,a=e.field,r=a.onChange,o=a.onBlur,s=a.value,i=a.name;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(p.a,{defaultValue:s,value:s,name:i,onBlur:o,onChange:r,isMulti:!0,options:U}),Object(C.jsxs)("small",{className:"form-text text-muted",children:[Object(C.jsx)(x.b,{to:"/ajout-optionList?foods=".concat("foods","&options=","options"),children:"Ajouter un option Liste"})," "]}),(null===(t=ae.optionLists)||void 0===t?void 0:t.message)&&Object(C.jsx)("div",{style:{display:"block"},className:"invalid-feedback",children:null===(n=ae.optionLists)||void 0===n?void 0:n.message})]})}})]}),Object(C.jsx)(d.o,{xs:12,children:Object(C.jsx)(d.f,{color:"primary",type:"submit",className:re?"disabled":" ",children:"Submit"})})]})})]})})]})}}}]);
//# sourceMappingURL=17.9c616f89.chunk.js.map