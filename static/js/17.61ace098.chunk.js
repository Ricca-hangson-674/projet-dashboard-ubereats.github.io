(this["webpackJsonpprojet-uber-eats-dashboard"]=this["webpackJsonpprojet-uber-eats-dashboard"]||[]).push([[17],{552:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={env:"prod",endpointLocal:"http://127.0.0.1:5059",endpointProd:"https://projet-eats-nrh.herokuapp.com"}},553:function(e,t,n){"use strict";n(0);var a=n(4),r=n(2),o=function(e){var t=e.variant,n=e.children;return Object(r.jsx)(a.a,{color:t,children:n})};o.defaultProps={variant:"info"},t.a=o},601:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var a=n(550),r=n.n(a),o=n(551),s=n(555),c=n.n(s),i=n(552),u=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n,a,o,s,u,l,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===i.a.env?i.a.endpointLocal:i.a.endpointProd,o=t?"".concat(a,"/api/categories/").concat(t):"".concat(a,"/api/categories"),e.next=7,c.a.get("".concat(o),n);case 7:return s=e.sent,u=s.data,e.abrupt("return",{status:!0,data:u});case 12:return e.prev=12,e.t0=e.catch(1),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:l});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,s,u,l,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:null,e.prev=1,o={headers:{"Content-Type":"application/json"}},s="local"===i.a.env?i.a.endpointLocal:i.a.endpointProd,u=null,!n){e.next=11;break}return e.next=8,c.a.put("".concat(s,"/api/categories/").concat(n),t,o);case 8:u=e.sent,e.next=14;break;case 11:return e.next=13,c.a.post("".concat(s,"/api/categories"),t,o);case 13:u=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=u)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:l});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()},602:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var a=n(550),r=n.n(a),o=n(551),s=n(555),c=n.n(s),i=n(552),u=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n,a,o,s,u,l,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===i.a.env?i.a.endpointLocal:i.a.endpointProd,o=t?"".concat(a,"/api/optionLists/").concat(t):"".concat(a,"/api/optionLists"),e.next=7,c.a.get("".concat(o),n);case 7:return s=e.sent,u=s.data,e.abrupt("return",{status:!0,data:u});case 12:return e.prev=12,e.t0=e.catch(1),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:l});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,s,u,l,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:null,e.prev=1,o={headers:{"Content-Type":"application/json"}},s="local"===i.a.env?i.a.endpointLocal:i.a.endpointProd,u=null,!n){e.next=11;break}return e.next=8,c.a.put("".concat(s,"/api/optionLists/").concat(n),t,o);case 8:u=e.sent,e.next=14;break;case 11:return e.next=13,c.a.post("".concat(s,"/api/optionLists"),t,o);case 13:u=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=u)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:l});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()},799:function(e,t,n){"use strict";n.r(t);var a=n(571),r=n(28),o=n(550),s=n.n(o),c=n(558),i=n(551),u=n(554),l=n(0),d=n(4),p=n(636),j=n(174),b=n(562),v=n(569),h=n(567),m=n(26),f=n(52),x=n(553),O=n(555),g=n.n(O),y=n(552),k=function(){var e=Object(i.a)(s.a.mark((function e(){var t,n,a,r,o,c,i,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:null,e.prev=1,n={headers:{"Content-Type":"application/json"}},a="local"===y.a.env?y.a.endpointLocal:y.a.endpointProd,r=t?"".concat(a,"/api/foods/").concat(t):"".concat(a,"/api/foods"),e.next=7,g.a.get("".concat(r),n);case 7:return o=e.sent,c=o.data,e.abrupt("return",{status:!0,data:c});case 12:return e.prev=12,e.t0=e.catch(1),i=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:i});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a,r,o,c,i,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:null,e.prev=1,r={headers:{"Content-Type":"application/json"}},o="local"===y.a.env?y.a.endpointLocal:y.a.endpointProd,c=null,!n){e.next=11;break}return e.next=8,g.a.put("".concat(o,"/api/foods/").concat(n),t,r);case 8:c=e.sent,e.next=14;break;case 11:return e.next=13,g.a.post("".concat(o,"/api/foods"),t,r);case 13:c=e.sent;case 14:return e.abrupt("return",{status:!0,data:null===(a=c)||void 0===a?void 0:a.data});case 17:return e.prev=17,e.t0=e.catch(1),i=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,e.abrupt("return",{status:!1,error:i});case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}(),w=n(602),P=n(601),C=n(2),S=h.d().shape({name:h.f().required("name is required"),description:h.f().required("description is required"),price:h.c().required("price are required"),priceDrop:h.c(),category:h.f().required("category are required"),optionLists:h.a(),isPopular:h.b(),available:h.b(),promotion:h.b()});t.default=function(){var e,t,n,o,h=Object(l.useState)(null),O=Object(u.a)(h,2),g=O[0],y=O[1],q=Object(l.useState)(!1),D=Object(u.a)(q,2),A=D[0],F=D[1],N=Object(l.useState)(!1),T=Object(u.a)(N,2),z=T[0],E=T[1],_=Object(l.useState)(null),B=Object(u.a)(_,2),R=B[0],V=B[1],I=Object(l.useState)([]),J=Object(u.a)(I,2),M=J[0],U=J[1],G=Object(m.g)(),H=Object(m.i)().id,K=window.location.hash,Q=new URLSearchParams(K.substring(K.lastIndexOf("?"))),W=Q.has("restaurant")?Q.get("restaurant"):"restaurant",X=Q.has("category")?Q.get("category"):"category",Y=Q.has("optionLists")?Q.get("optionLists"):[];console.log("params",K.substring(K.lastIndexOf("?")),X,Y,W);var Z=Object(b.e)({resolver:Object(v.a)(S),mode:"onTouched"}),$=Z.register,ee=Z.handleSubmit,te=Z.formState,ne=te.errors,ae=te.isSubmitting,re=te.isValid,oe=Z.resetField,se=Z.setValue,ce=Z.control;Object(l.useEffect)((function(){function e(){return(e=Object(i.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.b)(null,null);case 2:return t=e.sent,e.next=5,Object(P.b)(null,null);case 5:n=e.sent,(null===t||void 0===t?void 0:t.status)?U(Object(c.a)(t.data.map((function(e){return{value:e._id,label:e.name}})))):y(null===t||void 0===t?void 0:t.error),(null===n||void 0===n?void 0:n.status)?V(Object(c.a)(n.data)):y(null===n||void 0===n?void 0:n.error);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}console.log("Run once, when the component mounts "),function(){e.apply(this,arguments)}()}),[]),Object(l.useEffect)((function(){if(console.log("useEffect, Dependency"),H){var e=function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(null,null);case 2:(null===(t=e.sent)||void 0===t?void 0:t.status)?(se("name",null===t||void 0===t?void 0:t.data.name),se("description",null===t||void 0===t?void 0:t.data.description),se("price",null===t||void 0===t?void 0:t.data.price),se("priceDrop",null===t||void 0===t?void 0:t.data.priceDrop),se("category",null===t||void 0===t?void 0:t.data.category),se("optionLists",null===t||void 0===t?void 0:t.data.optionLists),se("isPopular",null===t||void 0===t?void 0:t.data.isPopular),se("available",null===t||void 0===t?void 0:t.data.available),se("promotion",null===t||void 0===t?void 0:t.data.promotion)):y(null===t||void 0===t?void 0:t.error);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[H,se]);var ie=function(){var e=Object(i.a)(s.a.mark((function e(t){var n,o,c,i,u,l,d,p,j;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null,c=Object(r.a)(Object(r.a)({},t),{},{optionLists:t.optionLists.map((function(e){return e.value}))}),console.log("onSubmit",t,c),!re){e.next=9;break}return F(!1),E(!1),e.next=8,L(c,H);case 8:o=e.sent;case 9:if(!(null===(n=o)||void 0===n?void 0:n.status)){e.next=45;break}if(oe("name"),oe("description"),oe("price"),oe("priceDrop"),oe("category"),oe("optionLists"),oe("isPopular"),oe("available"),oe("promotion"),!c.category){e.next=23;break}if(!W){e.next=23;break}return e.next=23,Object(P.a)({restaurant:W},c.category);case 23:if(!c.optionLists.length){e.next=42;break}i=Object(a.a)(c.optionLists),e.prev=25,i.s();case 27:if((u=i.n()).done){e.next=34;break}return p=u.value,console.log("optionListFor",p),e.next=32,Object(w.a)({foods:[null===(l=o)||void 0===l||null===(d=l.data)||void 0===d?void 0:d._id]},p);case 32:e.next=27;break;case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(25),i.e(e.t0);case 39:return e.prev=39,i.f(),e.finish(39);case 42:F(!0),e.next=47;break;case 45:E(!0),y(null===(j=o)||void 0===j?void 0:j.error);case 47:case"end":return e.stop()}}),e,null,[[25,36,39,42]])})));return function(t){return e.apply(this,arguments)}}();return console.log("errors",ne),Object(C.jsxs)(d.P,{children:[Object(C.jsx)(j.f,{}),z&&Object(C.jsxs)(x.a,{children:[" ",g]}),A&&Object(C.jsxs)(x.a,{children:[" ","Success Ajout ou Edite"]}),Object(C.jsx)(d.o,{xs:12,children:Object(C.jsxs)(d.h,{className:"mb-4",children:[Object(C.jsx)(d.l,{children:Object(C.jsxs)(d.P,{children:[Object(C.jsx)(d.o,{sm:5,children:Object(C.jsx)("strong",{children:"Ajout Food"})}),Object(C.jsx)(d.o,{sm:7,children:Object(C.jsx)(d.g,{className:"float-end me-3",children:Object(C.jsx)(d.f,{color:"outline-secondary",className:"mx-0",onClick:function(){G.push("/restaurants")},children:"Retour"})})})]})}),Object(C.jsx)(d.i,{children:Object(C.jsxs)(d.x,{className:"row g-3 needs-validation ".concat(re&&"was-validated"),onSubmit:ee(ie),children:[Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"name",children:"Name"}),Object(C.jsx)(d.z,Object(r.a)({type:"text",id:"name",required:!0},$("name"))),Object(C.jsx)(d.y,{invalid:!0,children:null===(e=ne.name)||void 0===e?void 0:e.message})]}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"lastName",children:"Description"}),Object(C.jsx)(d.z,Object(r.a)({type:"text",id:"description",required:!0},$("description"))),Object(C.jsx)(d.y,{invalid:!0,children:null===(t=ne.description)||void 0===t?void 0:t.message})]}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"price",children:"Price"}),Object(C.jsx)(d.z,Object(r.a)({type:"number",id:"price",required:!0},$("price"))),Object(C.jsx)(d.y,{invalid:!0,children:null===(n=ne.price)||void 0===n?void 0:n.message})]}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"priceDrop",children:"PriceDrop"}),Object(C.jsx)(d.z,Object(r.a)({type:"number",id:"priceDrop"},$("priceDrop"))),Object(C.jsx)(d.y,{invalid:!0,children:null===(o=ne.priceDrop)||void 0===o?void 0:o.message})]}),Object(C.jsx)(d.o,{md:3,children:Object(C.jsx)(d.C,Object(r.a)({label:"isPopular",id:"isPopular"},$("isPopular")))}),Object(C.jsx)(d.o,{md:3,children:Object(C.jsx)(d.C,Object(r.a)({label:"available",id:"available"},$("available")))}),Object(C.jsx)(d.o,{md:3,children:Object(C.jsx)(d.C,Object(r.a)({label:"promotion",id:"promotion"},$("promotion")))}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"categorie",children:"Categorie"}),Object(C.jsxs)(d.B,Object(r.a)(Object(r.a)({"aria-label":"Categorie",id:"categorie"},$("category")),{},{children:[Object(C.jsx)("option",{disabled:!0,children:"..."}),(null===R||void 0===R?void 0:R.length)&&R.map((function(e){return Object(C.jsx)("option",{value:e._id,children:e.name},e._id)}))]})),Object(C.jsxs)("small",{className:"form-text text-muted",children:[Object(C.jsx)(f.b,{to:"/ajout-categorie?restaurant=".concat(W),children:"Ajouter une categorie"})," "]})]}),Object(C.jsxs)(d.o,{md:6,children:[Object(C.jsx)(d.A,{htmlFor:"optionLists",children:"Option Liste"}),Object(C.jsx)(b.a,{control:ce,name:"optionLists",render:function(e){var t,n,a=e.field,r=a.onChange,o=a.onBlur,s=a.value,c=a.name;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(p.a,{defaultValue:s,value:s,name:c,onBlur:o,onChange:r,isMulti:!0,options:M}),Object(C.jsxs)("small",{className:"form-text text-muted",children:[Object(C.jsx)(f.b,{to:"/ajout-optionList?foods=".concat("foods","&options=","options"),children:"Ajouter un option Liste"})," "]}),(null===(t=ne.optionLists)||void 0===t?void 0:t.message)&&Object(C.jsx)("div",{style:{display:"block"},className:"invalid-feedback",children:null===(n=ne.optionLists)||void 0===n?void 0:n.message})]})}})]}),Object(C.jsx)(d.o,{xs:12,children:Object(C.jsx)(d.f,{color:"primary",type:"submit",className:ae?"disabled":" ",children:"Submit"})})]})})]})})]})}}}]);
//# sourceMappingURL=17.61ace098.chunk.js.map